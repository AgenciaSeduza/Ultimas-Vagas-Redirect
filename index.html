<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
  <title>REDE SECRETA</title>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@500;700;900&display=swap" rel="stylesheet">
  <style>
    *{margin:0;padding:0;box-sizing:border-box;}
    body{background:#000;color:#fff;font-family:'Inter',sans-serif;display:flex;align-items:center;justify-content:center;min-height:100vh;padding:10px 0;background:radial-gradient(circle at 50% 30%,#220011,#000 70%);}
    .card{width:92%;max-width:360px;background:#0f0a0f;border-radius:24px;overflow:hidden;border:2px solid #ff1f5f;box-shadow:0 0 30px rgba(255,31,95,0.3);padding:14px 16px 18px;}
    .banner{width:100%;border-radius:16px;border:2.5px solid #ff4b8f;box-shadow:0 0 25px rgba(255,75,143,0.4);display:block;}
    .stats{display:flex;justify-content:center;gap:32px;margin:14px 0 10px;}
    .stat-item{text-align:center;line-height:1.2;}
    .num{font-size:24px;font-weight:900;color:#ff1f5f;text-shadow:0 0 10px rgba(255,31,95,0.6);}
    .txt{font-size:10.5px;color:#ff8fb8;letter-spacing:1px;font-weight:700;margin-top:3px;}
    .rating{display:flex;align-items:center;justify-content:center;gap:8px;margin:10px 0;}
    .stars{font-size:20px;color:#ffd700;filter:drop-shadow(0 0 8px #ffd700);}
    .score{font-size:13.5px;color:#fff;font-weight:700;}
    .title{font-size:32px;font-weight:900;background:linear-gradient(90deg,#ff1f5f,#ff6ba8,#ff8fc7);-webkit-background-clip:text;-webkit-text-fill-color:transparent;text-align:center;line-height:1.05;margin:8px 0 12px;text-shadow:0 0 15px rgba(255,31,95,0.3);}
    .tutorial-img{width:100%;border-radius:14px;margin:12px 0;border:2px solid #ff4b8f;box-shadow:0 0 20px rgba(255,75,143,0.35);}
    .vagas{font-size:19px;color:#fff;text-align:center;margin:8px 0 6px;font-weight:800;}
    .fire{font-size:24px;vertical-align:middle;margin-right:6px;animation:f 1.4s infinite;}
    @keyframes f{0%,100%{transform:translateY(0)}50%{transform:translateY(-8px)}}
    .small{font-size:11.5px;color:#ff9fc8;display:block;margin-top:3px;}
    .btn{display:block;background:linear-gradient(45deg,#ff1f5f,#ff4b8f);color:#fff;font-size:20px;font-weight:900;text-decoration:none;padding:16px;border-radius:50px;margin:16px auto 10px;width:88%;text-align:center;box-shadow:0 8px 25px rgba(255,31,95,0.4);position:relative;overflow:hidden;}
    .btn::before{content:"";position:absolute;top:-50%;left:-50%;width:200%;height:200%;background:rgba(255,255,255,0.1);transform:rotate(30deg);opacity:0;}
    .btn:hover::before{animation:shine 1.5s infinite;}
    @keyframes shine{0%{transform:translateX(-100%) translateY(-100%) rotate(30deg);opacity:0;}50%{opacity:1;}100%{transform:translateX(100%) translateY(100%) rotate(30deg);opacity:0;}}
    .warning{font-size:12px;color:#ffb38f;text-align:center;margin-top:10px;font-weight:600;}
  </style>
</head>
<body>

<div class="card">
  <img src="banner.jpg" alt="Rede Secreta" class="banner">
  <div class="stats">
    <div class="stat-item"><div class="num">18.3K+</div><div class="txt">MEMBROS ATIVOS</div></div>
    <div class="stat-item"><div class="num">4.8K+</div><div class="txt">ONLINE AGORA</div></div>
  </div>
  <div class="rating"><div class="stars">★★★★★</div><div class="score">4.9/5 (2.892 avaliações)</div></div>
  <div class="title">CONTEÚDO<br>EXCLUSIVO</div>
  <img src="foto.jpg" alt="Como entrar" class="tutorial-img">
  <div class="vagas">
    <span class="fire">APENAS 4 VAGAS RESTANTES</span>
    <span class="small">Acesso liberado por tempo limitado</span>
  </div>
  <a id="enter-btn" class="btn" href="https://apextry.com/go/tktkadsrede" target="_blank">
    ENTRAR AGORA →
  </a>
  <div class="warning">CONTEÚDO PARA MAIORES DE 18 ANOS</div>
</div>

<!-- PIXEL CLIENT-SIDE -->
<script>
  !function (w, d, t) {
    w.TiktokAnalyticsObject = t; var ttq = w[t] = w[t] || [];
    ttq.methods = ["page","track","identify","instances","debug","on","off","once","ready","alias","group","enableCookie","disableCookie","holdConsent","revokeConsent","grantConsent"];
    ttq.setAndDefer = function(t, e) { t[e] = function() { t.push([e].concat(Array.prototype.slice.call(arguments, 0))) } };
    for (var i = 0; i < ttq.methods.length; i++) ttq.setAndDefer(ttq, ttq.methods[i]);
    ttq.instance = function(t) { for (var e = ttq._i[t] || [], n = 0; n < ttq.methods.length; n++) ttq.setAndDefer(e, ttq.methods[n]); return e };
    ttq.load = function(e, n) {
      var r = "https://analytics.tiktok.com/i18n/pixel/events.js", o = n && n.partner;
      ttq._i = ttq._i || {}, ttq._i[e] = [], ttq._i[e]._u = r, ttq._t = ttq._t || {}, ttq._t[e] = +new Date, ttq._o = ttq._o || {}, ttq._o[e] = n || {};
      var n = document.createElement("script"); n.type = "text/javascript", n.async = !0, n.src = r + "?sdkid=" + e + "&lib=" + t;
      var s = document.getElementsByTagName("script")[0]; s.parentNode.insertBefore(n, s);
    };
    ttq.load('D4FRJPBC77UEBGICQPK0'); ttq.page();
  }(window, document, 'ttq');
</script>

<!-- SERVER-SIDE + EVENTOS CORRIGIDOS -->
<script>
  const TIKTOK_PIXEL_ID = 'D4FRJPBC77UEBGICQPK0';
  const TIKTOK_ACCESS_TOKEN = 'bf597b03c4b470ca9687deb287f7a7b92b62681e';
  const API_ENDPOINT = 'https://business-api.tiktok.com/open_api/v1.3/event/track/';

  function generateEventId(eventName) {
    return `${eventName}_${Date.now()}_${Math.random().toString(36).substr(2, 9)}`;
  }

  async function sendTikTokServerEvent(eventName, extraProps = {}) {
    const baseProps = {
      content_type: 'product',
      content_id: 'REDE_SECRETA_001',
      content_name: 'Rede Secreta VIP',
      currency: 'BRL',
      value: 18.00
    };

    const payload = {
      pixel_code: TIKTOK_PIXEL_ID,
      event: eventName,
      event_id: generateEventId(eventName),
      timestamp: new Date().toISOString(),
      context: {
        user_agent: navigator.userAgent,
        ip: '',
        user: { external_id: '', phone_number: '', email: '' },
        page: { url: window.location.href, referrer: document.referrer || '' }
      },
      properties: { ...baseProps, ...extraProps }
    };

    try {
      await fetch(API_ENDPOINT, {
        method: 'POST',
        headers: { 'Access-Token': TIKTOK_ACCESS_TOKEN, 'Content-Type': 'application/json' },
        body: JSON.stringify(payload)
      });
    } catch (err) {}
  }

  // ViewContent
  window.addEventListener('load', () => {
    sendTikTokServerEvent('ViewContent');
    if (window.ttq) {
      ttq.track('ViewContent', {
        content_id: 'REDE_SECRETA_001',
        content_type: 'product',
        value: 18.00,
        currency: 'BRL'
      });
    }
  });

  // InitiateCheckout CORRIGIDO (agora com content_id)
  document.getElementById('enter-btn').addEventListener('click', () => {
    sendTikTokServerEvent('InitiateCheckout', { value: 18.00 });
    if (window.ttq) {
      ttq.track('InitiateCheckout', {
        content_id: 'REDE_SECRETA_001',     // ← ADICIONADO
        content_type: 'product',            // ← ADICIONADO
        value: 18.00,
        currency: 'BRL'
      });
    }
  });
</script>

</body>
</html>
